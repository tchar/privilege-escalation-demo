#include <stdlib.h>
#include <stdio.h>
#include <string.h>

// https://stackoverflow.com/a/7666577
char *hash(char *buff, char *str)
{
    unsigned long hash = 5381;
    int c = *str++;

    while (c) {
        hash = ((hash << 5) + hash) + c; /* hash * 33 + c */
		c = *str++;
	}

	
	sprintf(buff, "%lu", hash);
    return buff;
}

int main(int argc, char *argv[]){ 
	if(argc==2){
		char *hashed_pwd = malloc(256 * sizeof(char));
		hash(hashed_pwd, argv[1]);
		printf("Checking Licence: %s\n", argv[1]);
		if(strcmp(hashed_pwd, "798418066827541118")==0){
			printf("Access Granted!\n");
			printf("Your are 1337 h4xx0r\n");
		}
		else{
			printf("Wrong!\n");
		}
		free(hashed_pwd);
	}
	else{
		fprintf(stderr, "Usage: %s <password>\n", argv[0]);
		return 1;
	}
	
	return 0;
}
